<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="courrier_entete" language="groovy" pageWidth="595" pageHeight="802" columnWidth="595" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" scriptletClass="com.xxx..reporting.scriptlet.XXXScriptlet">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="CONTACT_ID" class="java.lang.Long">
		<defaultValueExpression><![CDATA[353]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["D:/XXX/web/bean/courrier/"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
     CONTACT."NOM" AS CONTACT_NOM,
     CONTACT."PRENOM" AS CONTACT_PRENOM,
     CONTACT."CIVILITE" AS CONTACT_CIVILITE,
     ADRESSE."CODE_POSTAL" AS ADRESSE_CODE_POSTAL,
     ADRESSE."VILLE" AS ADRESSE_VILLE,
     ADRESSE."TYPE_VOIE" AS ADRESSE_TYPE_VOIE,
     ADRESSE."NOM_VOIE" AS ADRESSE_NOM_VOIE,
     ADRESSE."NUMERO" AS ADRESSE_NUMERO,
     ORGANISME_GESTION."RAISON_SOCIALE" AS ORGANISME_GESTION_RAISON_SOCIA
FROM
     "THD_BDI"."ADRESSE" ADRESSE INNER JOIN "THD_BDI"."CONTACT" CONTACT ON ADRESSE."ID_RA" = CONTACT."ADRESSE_FK"   LEFT JOIN "THD_BDI"."CONTACTS2ORGANISME_GESTIONS" CONTACTS2ORGANISME_GESTIONS ON CONTACT."ID" = CONTACTS2ORGANISME_GESTIONS."CONTACTS_FK"
     LEFT JOIN "THD_BDI"."ORGANISME_GESTION" ORGANISME_GESTION ON CONTACTS2ORGANISME_GESTIONS."ORGANISME_GESTIONS_FK" = ORGANISME_GESTION."ID"

WHERE  CONTACT."ID"=$P{CONTACT_ID}]]>
	</queryString>
	<field name="CONTACT_NOM" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="CONTACT_PRENOM" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="CONTACT_CIVILITE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADRESSE_CODE_POSTAL" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADRESSE_VILLE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADRESSE_TYPE_VOIE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADRESSE_NOM_VOIE" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ADRESSE_NUMERO" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ORGANISME_GESTION_RAISON_SOCIA" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<pageHeader>
		<band height="177">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" x="350" y="53" width="248" height="20" isRemoveLineWhenBlank="true">
					<printWhenExpression><![CDATA[$F{ORGANISME_GESTION_RAISON_SOCIA}!=null]]></printWhenExpression>
				</reportElement>
				<textElement rotation="None">
					<font size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{REPORT_SCRIPTLET}.getStringCharsToIndex($F{ORGANISME_GESTION_RAISON_SOCIA},40)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement stretchType="RelativeToTallestObject" x="350" y="112" width="248" height="43"/>
				<textElement markup="styled">
					<font size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{ADRESSE_NUMERO}+", "+$F{ADRESSE_TYPE_VOIE}+" "+$F{ADRESSE_NOM_VOIE}+"<br/>"+
$F{ADRESSE_CODE_POSTAL}+" "+$F{ADRESSE_VILLE}+
"<br/><br/>"]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="0" y="0" width="64" height="64"/>
				<imageExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR}+"XXX.gif"]]></imageExpression>
			</image>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToBandHeight" x="350" y="73" width="248" height="38"/>
				<textElement markup="styled">
					<font size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["A lâ€™attention de <br/>"+$F{CONTACT_CIVILITE}+" "+ $P{REPORT_SCRIPTLET}.fillEmptyIfStringLength($F{CONTACT_PRENOM})+" "+ $F{CONTACT_NOM}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="135" width="248" height="20"/>
				<textElement>
					<font size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Envoi du : "+$P{REPORT_SCRIPTLET}.toFormattedDate(new java.util.Date(),"dd MMMMM yyyy")]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
</jasperReport>